<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shapes from Google Sheet</title>
    <script src="https://d3js.org/d3.v6.min.js"></script>
	<style>
        body {
            background-color: black;
            color: white;
            font-family: Arial, sans-serif;
            text-align: center;
        }
        h3 {
            color: #89CFF0;
            font-weight: bold;
            text-align: center;
        }
        footer {
            margin-top: 20px;
            text-align: center;
        }
        .image-logo img {
            margin-top: 10px;
    </style>
</head>
<body>

<h3>Creation Atlas Test</h3>
<p>by Daniele Fusetto</p>

    <svg width="800" height="800" id="canvas"></svg>

    <script>
        const URL = 'https://script.google.com/macros/s/AKfycbzwhBeNzR7Xz9gHEvgLe9rhTzmuxosNt2e7QQYlDgy5QNrVTqmxAQykvjPEyovfWi6BkA/exec'; // Replace this with your web app URL

        const DATA = {}; // This can be empty or contain any data you want to send to the Google Apps Script

		// Fetch data from Google Apps Script
		fetch(URL, {
			redirect: "follow",
			method: "POST",
			body: JSON.stringify(DATA),
			headers: {
				"Content-Type": "text/plain;charset=utf-8",
			},
		})
		.then(response => response.json())
		.then(data => {
			drawShapes(data);
		})
		.catch(error => {
			console.error('Error:', error);
		});

		function drawShapes(dataArray) {
			const svg = d3.select("#canvas"); // We're using the existing SVG, not appending a new one

			dataArray.forEach(data => {
				switch(data.shape) {
					case 'circle':
						svg.append("circle")
						   .attr("cx", data.x)
						   .attr("cy", data.y)
						   .attr("r", data.size)
						   .attr("fill", "white") // Using white as the fill color
						   .style("stroke", "black"); // Border color

						// Insert image logic here
						svg.append("image")
						   .attr("xlink:href", data.image)
						   .attr("x", data.x - data.size)
						   .attr("y", data.y - data.size)
						   .attr("width", 2 * data.size)
						   .attr("height", 2 * data.size);

						if (data.title) { // Using 'title' now instead of 'text'
							svg.append("text")
							   .attr("x", data.x)
							   .attr("y", data.y)
							   .attr("text-anchor", "middle")
							   .text(data.title);
						}
						break;

					case 'square':
						svg.append("rect")
						   .attr("x", data.x - data.size / 2)
						   .attr("y", data.y - data.size / 2)
						   .attr("width", data.size)
						   .attr("height", data.size)
						   .attr("fill", "white");

						// Insert image logic here
						svg.append("image")
						   .attr("xlink:href", data.image)
						   .attr("x", data.x - data.size / 2)
						   .attr("y", data.y - data.size / 2)
						   .attr("width", data.size)
						   .attr("height", data.size);

						if (data.title) {
							svg.append("text")
							   .attr("x", data.x)
							   .attr("y", data.y)
							   .attr("text-anchor", "middle")
							   .text(data.title);
						}
						break;
				}
			});
		}


		</script>
	<!-- Footer -->
<footer>
    <div class="image-logo">
        <!-- Use local asset for logo -->
        <img src="assets/logo.png" alt="Primorden Logo" width="23%" height="auto">
    </div>
    <p>Chatchill | Version 1.0</p>
</footer>
</body>
</html>
